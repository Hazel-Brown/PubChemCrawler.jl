<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · PubChemCrawler.jl</title><link rel="canonical" href="https://JuliaHealth.github.io/PubChemCrawler.jl/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PubChemCrawler.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Before-you-start:-be-aware-of-search-limits"><span>Before you start: be aware of search limits</span></a></li><li><a class="tocitem" href="#Getting-started"><span>Getting started</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PubChemCrawler"><a class="docs-heading-anchor" href="#PubChemCrawler">PubChemCrawler</a><a id="PubChemCrawler-1"></a><a class="docs-heading-anchor-permalink" href="#PubChemCrawler" title="Permalink"></a></h1><p>PubChemCrawler makes it easier to search the <a href="https://pubchem.ncbi.nlm.nih.gov/">PubChem database</a> from Julia. You can use it to access information about particular compounds or query substructures.</p><p>The package supports only a subset of the available <a href="https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest">functionality</a>, but it is fairly straightforward to expand to other types of query. Pull requests are welcome! If you do want to make improvements to this package, this <a href="https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest-tutorial">tutorial</a> might help you get started.</p><h2 id="Before-you-start:-be-aware-of-search-limits"><a class="docs-heading-anchor" href="#Before-you-start:-be-aware-of-search-limits">Before you start: be aware of search limits</a><a id="Before-you-start:-be-aware-of-search-limits-1"></a><a class="docs-heading-anchor-permalink" href="#Before-you-start:-be-aware-of-search-limits" title="Permalink"></a></h2><p>PubChem places significant limits on requests:</p><ul><li>No more than 5 requests per second</li><li>No more than 400 requests per minute</li><li>No longer than 300 second running time per minute</li><li>Requests made via REST (the API targeted by this package) time out after 30s. There seems to be some caching, though, so sometimes it works to just resubmit the request.</li></ul><p>The latter constraint is worth a bit of thought. Substructure search requests can sometimes generate hundreds of thousands of hits, and asking for lots of different properties for many different compounds can prolong the request beyond the timeout limit. One recommendation is to pursue a &quot;staged&quot; approach, where you first request just a few simple properties (e.g., <code>MolecularFormula</code> rather than the full <code>SMILES</code> string) and use that information to narrow the list of candidates. With a smaller list, it becomes feasible to request more detailed information.</p><h2 id="Getting-started"><a class="docs-heading-anchor" href="#Getting-started">Getting started</a><a id="Getting-started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-started" title="Permalink"></a></h2><p>Some queries make use of the CID, the <strong>C</strong>ompound <strong>ID</strong>entifier, which you can obtain in a variety of ways. Let&#39;s get the CID for aspirin:</p><pre><code class="language-julia">julia&gt; cid = get_cid(name=&quot;aspirin&quot;)
2244

julia&gt; cid = get_cid(smiles=&quot;CC(=O)OC1=CC=CC=C1C(=O)O&quot;)   # use the SMILES string
2244</code></pre><p>You can then retrieve a list of other properties:</p><pre><code class="language-julia">julia&gt; df = CSV.File(get_for_cids(cid; properties=&quot;MolecularFormula,MolecularWeight,XLogP,IsomericSMILES&quot;, output=&quot;CSV&quot;)) |&gt; DataFrame
1×5 DataFrame
│ Row │ CID   │ MolecularFormula │ MolecularWeight │ XLogP   │ IsomericSMILES           │
│     │ Int64 │ String           │ Float64         │ Float64 │ String                   │
├─────┼───────┼──────────────────┼─────────────────┼─────────┼──────────────────────────┤
│ 1   │ 2244  │ C9H8O4           │ 180.16          │ 1.2     │ CC(=O)OC1=CC=CC=C1C(=O)O │</code></pre><p>You can query such properties for a list of <code>cids</code>.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><h3 id="Queries"><a class="docs-heading-anchor" href="#Queries">Queries</a><a id="Queries-1"></a><a class="docs-heading-anchor-permalink" href="#Queries" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.get_cid" href="#PubChemCrawler.get_cid"><code>PubChemCrawler.get_cid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cid = get_cid(name=&quot;glucose&quot;)
cid = get_cid(smiles=&quot;glucose&quot;)</code></pre><p>Return the PubChem <strong>c</strong>ompound <strong>id</strong>entification number for the specified compound.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/5b7ef67e71057b89462af70aa95b96bf913ba9bd/src/query.jl#LL3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.query_substructure" href="#PubChemCrawler.query_substructure"><code>PubChemCrawler.query_substructure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">msg = query_substructure(;cid=nothing, smiles=nothing,                           # specifier for the substructure to search for
                          properties=&quot;MolecularFormula,MolecularWeight,XLogP,&quot;,  # properties to retrieve
                          output=&quot;CSV&quot;)                                          # output format</code></pre><p>Perform a substructure search of the entire database. You can specify the target via its <code>cid</code>, the SMILES string, or its <code>name</code>. Specify the <code>properties</code> you want to retrieve as a comma-separated list from among the choices in http://pubchemdocs.ncbi.nlm.nih.gov/pug-rest, &quot;Compound Property Tables&quot;.</p><p>The output is a <code>Vector{UInt8}</code>. For <code>output=&quot;CSV&quot;</code>, a good choice to generate a manipulable result is <code>DataFrame(CSV.File(msg))</code> from the DataFrames and CSV packages, respectively. Alternatively <code>String(msg)</code> will convert it to a string, which you can write to a file.</p><p><strong>Example</strong></p><pre><code class="language-none">julia&gt; using PubChemCrawler, CSV, DataFrames

julia&gt; cid = get_cid(name=&quot;estriol&quot;)
5756

julia&gt; df = CSV.File(query_substructure(;cid)) |&gt; DataFrame      # on Julia 1.0, use `(;cid=cid)`
11607×4 DataFrame
│ Row  │ CID       │ MolecularFormula │ MolecularWeight │ XLogP    │
│      │ Int64     │ String           │ Float64         │ Float64? │
├──────┼───────────┼──────────────────┼─────────────────┼──────────┤
│ 1    │ 5756      │ C18H24O3         │ 288.4           │ 2.5      │
│ 2    │ 5281904   │ C24H32O9         │ 464.5           │ 1.1      │
│ 3    │ 27125     │ C18H24O4         │ 304.4           │ 1.5      │
...</code></pre><p>will query for derivatives of <a href="https://en.wikipedia.org/wiki/Estriol">estriol</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/5b7ef67e71057b89462af70aa95b96bf913ba9bd/src/query.jl#LL18-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.get_for_cids" href="#PubChemCrawler.get_for_cids"><code>PubChemCrawler.get_for_cids</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">msg = get_for_cids(cids; properties=nothing, xrefs=nothing, output=&quot;CSV&quot;)</code></pre><p>Retrieve the given <code>properties</code> or <code>xrefs</code> for a list of compounds specified by their <code>cids</code>.</p><p>See <a href="#PubChemCrawler.query_substructure"><code>query_substructure</code></a> for information about the arguments and return value. The supported values for <code>xrefs</code> are available at https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest under &quot;XRefs&quot;.</p><p><strong>Example</strong></p><pre><code class="language-none">julia&gt; using PubChem, JSON3

julia&gt; cids = [get_cid(name=&quot;cyclic guanosine monophosphate&quot;), get_cid(name=&quot;aspirin&quot;)]
2-element Array{Int64,1}:
 135398570
      2244

julia&gt; dct = JSON3.read(get_for_cids(cids; xrefs=&quot;RN,&quot;, output=&quot;JSON&quot;))   # get the Registry Number(s) (CAS)
JSON3.Object{Array{UInt8,1},Array{UInt64,1}} with 1 entry:
  :InformationList =&gt; {…

julia&gt; dct[:InformationList][:Information]
2-element JSON3.Array{JSON3.Object,Array{UInt8,1},SubArray{UInt64,1,Array{UInt64,1},Tuple{UnitRange{Int64}},true}}:
 {
   &quot;CID&quot;: 135398570,
    &quot;RN&quot;: [
            &quot;40732-48-7&quot;,
            &quot;7665-99-8&quot;
          ]
}
 {
   &quot;CID&quot;: 2244,
    &quot;RN&quot;: [
            &quot;11126-35-5&quot;,
            &quot;156865-15-5&quot;,
            &quot;50-78-2&quot;,
            &quot;52080-78-1&quot;,
            &quot;921943-73-9&quot;,
            &quot;98201-60-6&quot;,
            &quot;99512-66-0&quot;
          ]
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/5b7ef67e71057b89462af70aa95b96bf913ba9bd/src/query.jl#LL69-L113">source</a></section></article><h3 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.parse_formula" href="#PubChemCrawler.parse_formula"><code>PubChemCrawler.parse_formula</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">atomcounts = parse_formula(str::AbstractString)</code></pre><p>Parse <code>str</code> as a chemical formula, return a list of <code>atom=&gt;multiplicity</code> pairs.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl">julia&gt; parse_formula(&quot;C2CaH2O6&quot;)
4-element Array{Pair{String,Int64},1}:
  &quot;C&quot; =&gt; 2
 &quot;Ca&quot; =&gt; 1
  &quot;H&quot; =&gt; 2
  &quot;O&quot; =&gt; 6</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/5b7ef67e71057b89462af70aa95b96bf913ba9bd/src/utils.jl#LL28-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PubChemCrawler.atomregex" href="#PubChemCrawler.atomregex"><code>PubChemCrawler.atomregex</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rex = atomregex(chemicalsymbol)</code></pre><p>Create a regular expression for detecting how many atoms of type <code>chemicalsymbol</code> are in a molecular formula.</p><p><strong>Examples</strong></p><p>The formula for calcium bicarbonate is Ca(HCO3)2, i.e., C2CaH2O6.</p><pre><code class="language-julia-repl">julia&gt; match(atomregex(&quot;C&quot;), &quot;C2CaH2O6&quot;)
RegexMatch(&quot;C2&quot;, 1=&quot;2&quot;)

julia&gt; match(atomregex(&quot;Ca&quot;), &quot;C2CaH2O6&quot;)
RegexMatch(&quot;Ca&quot;, 1=&quot;&quot;)

julia&gt; match(atomregex(&quot;H&quot;), &quot;C2CaH2O6&quot;)
RegexMatch(&quot;H2&quot;, 1=&quot;2&quot;)

julia&gt; match(atomregex(&quot;O&quot;), &quot;C2CaH2O6&quot;)
RegexMatch(&quot;O6&quot;, 1=&quot;6&quot;)</code></pre><p>Note that the regex for <code>&quot;C&quot;</code> does not match <code>&quot;Ca&quot;</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaHealth/PubChemCrawler.jl/blob/5b7ef67e71057b89462af70aa95b96bf913ba9bd/src/utils.jl#LL1-L25">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 11 November 2020 18:09">Wednesday 11 November 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
